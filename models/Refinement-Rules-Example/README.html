<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html lang="en">
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Refinement Rules Example | PnP Syntex Samples </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Refinement Rules Example | PnP Syntex Samples ">
    <meta name="generator" content="docfx 2.56.5.0">
    <meta name="description" content="This repository contains community samples that demonstrate different usage patterns and templates for Microsoft Syntex.">
    <link rel="shortcut icon" href="https://c.s-microsoft.com/favicon.ico?v2">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    <meta property="docfx:rel" content="../../">
    <meta property="docfx:newtab" content="true">
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../images/logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <label class="glyphicon glyphicon-search" for="search-query"></label>
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
                  <div class="contribution-panel mobile-hide pull-right">
                      <a href="https://github.com/pnp/syntex-samples/blob/main/docs/models/Refinement-Rules-Example/README.md/#L1" title="Improve this Doc" class="improve-doc-lg"><i class="glyphicon glyphicon-pencil"></i></a>
                  </div>
                    <h1 id="refinement-rules-example">Refinement Rules Example</h1>

<h2 id="summary">Summary</h2>
<p>This PnP template contains a Microsoft Syntex unstructured document processing model used to demonstrate the new refinement rules functionality that can be added to extractors.
Refinement rules are ran on the returned entity values from an extractor i.e remove duplicates, select first/last value or line etc.</p>
<p><img src="assets/training-file-example.png" alt="Refinement Rules Example"></p>
<p>All five refinement rules currently available to be used are demonstrated in this model.</p>
<p>The sample features the following:</p>
<ul>
<li>Classifier</li>
<li>7 extractors</li>
<li>7 training files (7 positive examples, 1 negative example)</li>
</ul>
<p>The extractors in this model are:</p>
<table>
<thead>
<tr>
<th>Extractor Name</th>
<th>Explanation Count</th>
<th>Types</th>
<th>Refinement Rule</th>
</tr>
</thead>
<tbody>
<tr>
<td>Section Authors</td>
<td>1</td>
<td>Phrase List</td>
<td></td>
</tr>
<tr>
<td>Section Authors (First Named)</td>
<td>1</td>
<td>Phrase List</td>
<td>Keep one or more of the first values</td>
</tr>
<tr>
<td>Section Authors (Last Named)</td>
<td>1</td>
<td>Phrase List</td>
<td>Keep one or more of the first values</td>
</tr>
<tr>
<td>Section Authors (No Duplicates)</td>
<td>1</td>
<td>Phrase List</td>
<td>Remove duplicate values</td>
</tr>
<tr>
<td>Section 1 Summary</td>
<td>2</td>
<td>Phrase List</td>
<td></td>
</tr>
<tr>
<td>Section 1 Summary (First Line)</td>
<td>2</td>
<td>Phrase List</td>
<td>Keep one or more of the first lines</td>
</tr>
<tr>
<td>Section 1 Summary (Last Line)</td>
<td>2</td>
<td>Phrase List</td>
<td>Keep one or more of the last lines</td>
</tr>
</tbody>
</table>
<h2 id="using-the-model">Using the model</h2>
<p>To use the model in your tenant you must have access to a Content Center.</p>
<p>To upload the model, apply the PnP site template to a content center using <a href="https://pnp.github.io/powershell/">PnP PowerShell</a>:</p>
<pre><code class="lang-powershell">Connect-PnPOnline -Url &quot;https://contoso.sharepoint.com/sites/yourContentCenter&quot;

Invoke-PnPSiteTemplate -Path .\RefinementRuleExample.pnp
</code></pre>
<p>Further details on refinement rules can be found at: <a href="https://www.leonarmston.com/2022/04/sharepoint-syntex-testing-out-new-refinement-rules-for-document-understanding-extractor-models/">SharePoint Syntex: Testing Out New Refinement Rules for Document Understanding Extractor Models</a></p>
<h2 id="sample">Sample</h2>
<p>You can find the model source code including training files here: <a href="https://github.com/pnp/syntex-samples/tree/main/models/Refinement-Rules-Example">/models/Refinement-Rules-Example</a></p>
<table>
<thead>
<tr>
<th>Solution</th>
<th>Author(s)</th>
</tr>
</thead>
<tbody>
<tr>
<td>RefinementRuleExample.pnp</td>
<td><a href="https://github.com/LeonArmston">Leon Armston</a></td>
</tr>
</tbody>
</table>
<h2 id="version-history">Version history</h2>
<table>
<thead>
<tr>
<th>Version</th>
<th>Date</th>
<th>Comments</th>
</tr>
</thead>
<tbody>
<tr>
<td>1.0</td>
<td>Apr 26, 2022</td>
<td>Initial release</td>
</tr>
</tbody>
</table>
<h2 id="disclaimer">Disclaimer</h2>
<p><strong>THIS CODE IS PROVIDED <em>AS IS</em> WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED, INCLUDING ANY IMPLIED WARRANTIES OF FITNESS FOR A PARTICULAR PURPOSE, MERCHANTABILITY, OR NON-INFRINGEMENT.</strong></p>
<hr>
<img src="https://pnptelemetry.azurewebsites.net/syntex-samples/models/Refinement-Rules-Example">
</article>
          </div>
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              </nav>
            </div>
          </div>        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <span>Syntex Samples<br>Generated by <strong><a href='https://dotnet.github.io/docfx' alt='Doc FX Website'>DocFX</a></strong> with <strong><a href='https://ovasquez.github.io/docfx-material' alt='DocFx Material Theme'>Material UI</a></strong></span>
            
          </div>
        </div>
      </footer>    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>  </body>
</html>